cmake_minimum_required(VERSION 3.0.2)

project(open-dis-cpp)

set(CMAKE_INSTALL_PREFIX "/usr")

set(INSTALL_INCLUDE_DIR_BASE include/OpenDis)
set(INSTALL_LIB_DIR_BASE lib64/OpenDis)

add_subdirectory(src)

set(TARGET_NAME OpenDis)
set(INSTALL_INCLUDE_DIR ${INSTALL_INCLUDE_DIR_BASE})
set(INSTALL_LIB_DIR ${INSTALL_LIB_DIR_BASE})

add_library(${TARGET_NAME} INTERFACE)
target_link_libraries(${TARGET_NAME} INTERFACE OpenDis6)
install(TARGETS ${TARGET_NAME} EXPORT ${TARGET_NAME}Targets ARCHIVE DESTINATION ${INSTALL_LIB_DIR})
install(EXPORT ${TARGET_NAME}Targets DESTINATION ${INSTALL_LIB_DIR})

install(FILES ${TARGET_NAME}Config.cmake DESTINATION ${INSTALL_LIB_DIR})

# build rpm
set(CPACK_PACKAGING_INSTALL_PREFIX "/usr")
set(CPACK_GENERATOR "RPM")
set(CPACK_PACKAGE_VERSION 1.0.0)
set(CPACK_PACKAGE_NAME "OpenDis")
set(CPACK_PACKAGE_DESCRIPTION_SUMMARY "The open DIS cpp library")
set(CPACK_PACKAGE_FILE_NAME "${CPACK_PACKAGE_NAME}-${CPACK_PACKAGE_VERSION}.${CMAKE_SYSTEM_PROCESSOR}")
set(CPACK_PACKAGE_RPM_DIR "${CMAKE_CURRENT_BINARY_DIR}/_CPack_Packages/Linux/RPM")
set(CPACK_PACKAGE_PACKAGER $ENV{USER})
set(CPACK_PACKAGE_DESCRIPTION_SUMMARY "The open DIS cpp library")

include(CPack)
